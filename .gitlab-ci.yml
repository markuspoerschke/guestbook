before_script:
  # Install missing packages
  - apt-get update -yqq && apt-get install git zlib1g-dev -yqq
  - curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer
  - docker-php-ext-install pdo pdo_mysql zip
  - php bin/load-schema.php

services:
  - mysql

variables:
  MYSQL_ROOT_PASSWORD: root
  MYSQL_DATABASE: guestbook
  GUESTBOOK_DB_DSN: mysql:dbname=guestbook;host=mysql
  GUESTBOOK_DB_USER: root
  GUESTBOOK_DB_PASSWORD: root

test:7.4:
  image: php:7.4
  script:
    - make test

test:7.3:
  image: php:7.3
  script:
    - make test
