before_script:
  # Install missing packages
  - apt-get update -yqq && apt-get install git zlib1g-dev -yqq
  - curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer
  - docker-php-ext-install pdo pdo_mysql zip

  - php -v
  - php bin/load-schema.php
  - composer install

services:
  - mysql

variables:
  MYSQL_ROOT_PASSWORD: root
  MYSQL_DATABASE: guestbook
  GUESTBOOK_DB_DSN: mysql:dbname=guestbook;host=mysql
  GUESTBOOK_DB_USER: root
  GUESTBOOK_DB_PASSWORD: root

test:7.0:
  image: php:7.0
  script:
    - composer test

test:7.1:
  image: php:7.1
  script:
    - composer test

test:7.2:
  image: php:7.2
  script:
    - composer test
